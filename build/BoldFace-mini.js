/*jslint nomen: false, debug: true, evil: false, vars: true, indent: 2 */
/*global $, _, GoogleWebFonts, jQuery, clearInterval: false, clearTimeout: false, document: false, event: false, frames: false, history: false, Image: false, location: false, name: false, navigator: false, Option: false, parent: false, screen: false, setInterval: false, setTimeout: false, window: false, XMLHttpRequest: false */
(function(a,b){var c={};c.version="0.0.2",c.mode="development",c.html="<div></div>",c.bookmarklet_host="http://0.0.0.0:9000",c.init=function(){c.loadDependencies(),c.init_after_jQueryIsLoaded()},c.loadDependencies=function(){c.load_js("cdnjs.cloudflare.com/ajax/libs/jquery/1.6.2/jquery.min.js"),c.load_js("cdnjs.cloudflare.com/ajax/libs/jqueryui/1.8.13/jquery-ui.min.js"),c.load_js("cdnjs.cloudflare.com/ajax/libs/underscore.js/1.1.7/underscore-min.js"),c.load_app_js("/agirorn/BoldFace/master/build/googleWebFonts.js"),c.load_app_css("/agirorn/BoldFace/master/build/BoldFace.css")},c.addHtmlToBody=function(){$("body").append($(c.html)),$("#BoldFace").draggable({handle:"h1"}),c.setupSelectionList(),c.populateFontsList()},c.htmlToBodyReady=function(a,b,d){$("body").append(a),$("#BoldFace").draggable({handle:"h1"}),c.setupSelectionList(),c.populateFontsList()},c.familyClass=function(a){return a.replace(" ","_")},c.populateFontsList=function(){var a,b=$("#BoldFace > #font_list > ul");b.html(""),_.each(GoogleWebFonts.items,function(d){a=$("<li>"+d.family+"</li>"),a.css("font-family",d.family),a.addClass(c.familyClass(d.family)),b.append(a)})},c.setupSelectionList=function(){$("body").bind("keydown",c.move_list_up_or_down),$("#BoldFace > #font_list").click(c.select_item),$("#BoldFace .size ul").click(c.select_item),$("body").click(function(){$("#BoldFace .focused").removeClass("focused")})},c.move_list_up_or_down=function(a){var b,d,e=$(".focused");if(e.length>=1){b=e.find(".selected");if(a.which===40)return b.parent().children("li").index(b)!==b.siblings().length?(d=b.next(),$(d).addClass("selected"),$(b).removeClass("selected"),c.selectionChanged(),!1):!1;if(a.which===38&&b.parent().children("li").index(b)!==0)return d=b.prev(),$(d).addClass("selected"),$(b).removeClass("selected"),c.selectionChanged(),!1}},c.select_item=function(a){return a.preventDefault(),$(a.target).parent().find(".selected").removeClass("selected"),$("#BoldFace .focused").removeClass("focused"),$(a.target).parent().addClass("focused"),$(a.target).parent(".focused").find(".selected").removeClass("selected"),$(a.target).addClass("selected"),c.selectionChanged(),!1},c.loadGoogleWebFonts=function(){var a,b,c="http://fonts.googleapis.com/css?family=",d=$("head");_.each(GoogleWebFonts.items,function(e){a=e.family.replace(/ /g,"+"),b=$("<link rel='stylesheet' type='text/css'>"),href=c+a,e.variants.length>1&&(href=href+":"+_.select(e.variants,function(a){return a!=="regular"}).join(",")),b.attr("href",href),d.append(b)})},c.selectionChanged=function(){var a=$("#BoldFace .selector").val(),b=$(a).filter(":not(#BoldFace *)");b.css("font-family",$("#BoldFace #font_list .selected").text()),b.css("font-size",$("#BoldFace .size ul .selected").text());var d=$("#BoldFace #font_list .selected").text(),e=_.detect(GoogleWebFonts.items,function(a){return a.family===d});d!==""&&c.setVariants(e)},c.setVariants=function(a){var b,c=$(".variants select");c.html(""),_.each(a.variants,function(a){b=$("<option>"+a+"</option>"),c.append(b)})},c.setSubsets=function(a){var b,c=$(".subsets select");c.html(""),_.each(a.subsets,function(a){b=$("<option>"+a+"</option>"),c.append(b)})},c.load_js=function(a){var c,d=b.createElement("script");d.src=("https:"===b.location.protocol?"https":"http")+"://"+a,d.type="text/javascript",d.async="true",c=b.getElementsByTagName("script")[0],c.parentNode.insertBefore(d,c)},c.load_js_https=function(a){var c,d=b.createElement("script");d.src="https://"+a,d.type="text/javascript",d.async="true",c=b.getElementsByTagName("script")[0],c.parentNode.insertBefore(d,c)},c.load_app_js=function(a){var d,e=b.createElement("script");e.src=c.bookmarklet_host+a,e.type="text/javascript",e.async="true",d=b.getElementsByTagName("script")[0],d.parentNode.insertBefore(e,d)},c.load_app_css=function(a){var d;a=c.bookmarklet_host+a,d=b.createElement("link"),d.rel="stylesheet",d.type="text/css",d.href=a,b.getElementsByTagName("head")[0].appendChild(d)},c.checkFor_jQuery=function(){typeof a.jQuery!="undefined"&&typeof a.GoogleWebFonts!="undefined"&&(clearInterval(c.checkFor_jQueryInterval),jQuery(b).ready(function(a){c.addHtmlToBody(),c.loadGoogleWebFonts()}))},c.init_after_jQueryIsLoaded=function(){c.checkFor_jQueryInterval=setInterval(c.checkFor_jQuery,100)},a.BoldFace=c,c.init()})(this,this.document)